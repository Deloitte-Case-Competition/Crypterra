<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.6/xlsx.full.min.js"></script>
  <script>
  var oFile;
  $(document).ready(function(){
    document.getElementById('file-object').addEventListener("change", function(e) {
      var files = e.target.files,file;
      if (!files || files.length == 0) return;
      file = files[0];
      var fileReader = new FileReader();
      fileReader.onload = function (e) {
        var filename = file.name;
        // pre-process data
        var binary = "";
        var bytes = new Uint8Array(e.target.result);
        var length = bytes.byteLength;
        for (var i = 0; i < length; i++) {
          binary += String.fromCharCode(bytes[i]);
        }
        // call 'xlsx' to read the file
        oFile = XLSX.read(binary, {type: 'binary', cellDates:true, cellStyles:true});
        console.log(oFile);
      };
      fileReader.readAsArrayBuffer(file);
    });
    $('#excel').click(function(e) {
      e.preventDefault();
      $.ajax({
        url: '/excel',
        type: 'POST',
        contentType: 'application/json',
        data: oFile,
        success: function(data){
          console.log(data);
      }});
    });

    $('#company').click(function(e) {
      e.preventDefault();
      console.log("Testing");
      var id = $('#id').val();
      var name = $('#name').val();
      var ceoName = $('#ceo-name').val();
      var lastName = $('#lastName').val();
      var ceoId = $('#ceo-id').val();
      var ceoSalary = $('#ceo-salary').val();
      var employees = [];
      var subsidiaries = [];
      var description = $('#description').val();
      var location = $('#location').val();
      var cash = $('#cash').val();
      var ceo = {
        firstName: ceoName,
        lastName: lastName,
        id: ceoId,
        salary: ceoSalary
      };
      var data = {
        id: id,
        name: name,
        ceo: ceo,
        employees: employees,
        description: description,
        subsidiaries: subsidiaries,
        location: location,
        cashBalance: cash
      };
      console.log(data);
      $.ajax({
        url: '/admin',
        type: 'POST',
        data: data,
        success: function(data){
          console.log(data);
      }});
    });
  });
  </script>
</head>
<body>
  <div class="container">
    <p>Upload your transactions in an excel file here.</p>
    <input id="file-object" type="file">
    <button id="excel">Send File</button>
    <p>Put your company info here.</p>
    <form>
      <input id="name" type="text" placeholder="Company Name"></input><br>
      <input id="id" type="text" placeholder="Company ID"></input><br>
      <input id="ceo-name" type="text" placeholder="CEO Name"></input><br>
      <input id="lastName" type="text" placeholder="CEO Last Name"></input><br>
      <input id="ceo-id" type="text" placeholder="CEO ID"></input><br>
      <input id="ceo-salary" type="text" placeholder="CEO Salary"></input><br>
      <input id="description" type="text" placeholder="Company Description"></input><br>
      <input id="location" type="text" placeholder="Company Location"></input><br>
      <input id="cash" type="text" placeholder="Cash Balance"></input><br>
      <button>Add Subsidiary</button><br>
      <button id="company">Send Data</button>
  </div>
</body>


</html>
